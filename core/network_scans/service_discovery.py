from scapy.all import IP, TCP, sr1, RandShort

def scan_ports(host, range_end=1024):
    open_ports = []

    # Voor elke poort in het bereik, stuur een SYN-pakket (begin van TCP-handshake)
    for port in range(1, range_end + 1):
        # Maak een TCP packet met de SYN vlag gezet (dit initieert de TCP handshake)
        packet = IP(dst=host)/TCP(sport=RandShort(), dport=port, flags="S")
        response = sr1(packet, timeout=1, verbose=0)

        if response:
            # Als er een antwoord is met de SYN en ACK vlaggen gezet, is de poort open.
            if response[TCP].flags == "SA":
                open_ports.append(port)

    return open_ports

# # Testen van de functie
# host_ip = "192.168.0.1"  # Pas dit aan naar het IP-adres dat je wilt scannen
# open_ports = scan_ports(host_ip)
# print(f"Open poorten op {host_ip}: {open_ports}")
