from scapy.all import ARP, Ether, srp

def discover_hosts(ip_range):
    # Een ARP-request packet maken dat vraagt naar het MAC-adres behorende bij een IP-adres
    arp_request = ARP(pdst=ip_range)
    broadcast = Ether(dst="ff:ff:ff:ff:ff:ff")  # Ethernet broadcast
    arp_request_broadcast = broadcast/arp_request

    # Stuur het packet en ontvang het antwoord
    answered_list = srp(arp_request_broadcast, timeout=2, verbose=0)[0]
    
    # Lijst van actieve hosts
    hosts = []

    for sent, received in answered_list:
        hosts.append({'ip': received.psrc, 'mac': received.hwsrc})

    return hosts

# Testen van de functie voor een specifiek IP-bereik
# ip_range = "192.168.0.1/24"  # Pas dit aan naar het gewenste IP-bereik
# active_hosts = discover_hosts(ip_range)
# for host in active_hosts:
#     print("IP:", host['ip'], "MAC:", host['mac'])
