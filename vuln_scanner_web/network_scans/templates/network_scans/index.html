<!-- network_scans/templates/network_scans/home.html -->
{% extends "base.html" %}

{% block title %}
Network Scans
{% endblock %}

{% block content %}
<!-- Content specific to network scans -->
<div class="network-page">
    <form method="POST" class="border bg-white" style="display:flex; flex-direction: column;" enctype="multipart/form-data">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit" name="host_discovery" class="btn btn-dark">Host Discovery</button>
        <button type="submit" name="pcap_analysis" class="btn btn-dark">pcap File Analysis</button>
        <button type="submit" name="os_detection" class="btn btn-dark">Remote OS Detection</button>
        <button type="submit" name="port_scanner" class="btn btn-dark">Port Scanner</button>
        <!-- Add more buttons as needed -->
    </form>

    {% if active_hosts %}
        <div class="table-responsive network-result border bg-white">
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>IP Address</th>
                        <th>MAC Address</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in active_hosts %}
                        <tr>
                            <td>{{ item.ip }}</td>
                            <td>{{ item.mac }}</td>
                        </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    {% endif %}
        <!-- Display results for PCAP analysis -->
        {% if pcap_analysis %}
        <div class="pcap-analysis table-responsive network-result border bg-white">
            <h2>PCAP Analysis Results</h2>
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Protocol</th>
                        <th>Amount of packets</th>
                        {% comment %} <th>Destination</th> {% endcomment %}
                        <!-- Add more headers based on your data structure -->
                    </tr>
                </thead>
                <tbody>
                        <tr>
                            <td>HTTP</td>
                            <td>{{ pcap_analysis.http_traffic }}</td>
                        </tr>
                        <tr>
                            <td>SSH</td>
                            <td>{{ pcap_analysis.ssh_traffic }}</td>
                        </tr>
                        <tr>
                            <td>ICMP (not 100% correct)</td>
                            <td>{{ pcap_analysis.icmp_traffic }}</td>
                        </tr>
                        <tr>
                            <td>SMTP</td>
                            <td>{{ pcap_analysis.smtp_traffic }}</td>
                        </tr>
                        <tr>
                            <td>POP3</td>
                            <td>{{ pcap_analysis.pop3_traffic }}</td>
                        </tr>
                        <tr>
                            <td>IMAP</td>
                            <td>{{ pcap_analysis.imap_traffic }}</td>
                        </tr>
                </tbody>
            </table>
        </div>
    {% endif %}
    {% if os_detection %}
        <div class="network-result border bg-white">
            <h3>OS Detection Result:</h3>
            <p>{{ os_detection }}</p>
        </div>
    {% endif %}
    {% if open_ports %}
        <div class="network-result border bg-white">
            <h3>Port Scanner Result:</h3>
            <p>{{ open_ports }}</p>
        </div>
    {% endif %}
</div>
{% endblock %}