import os
from django import forms
from django.conf import settings

class URLInputForm(forms.Form):
    url = forms.URLField(label='Enter URL (https://example.com)', required=True,
                         widget=forms.URLInput(attrs={'class': 'form-control'}))

    # Update the wordlist field to use ChoiceField
    wordlist = forms.ChoiceField(label='Wordlist', required=False)
    
    file_extensions = forms.CharField(
        label='File Extensions', required=False, help_text='Comma-separated, e.g., .php,.html')
    threads = forms.IntegerField(label='Threads', required=False, initial=200)

    def __init__(self, *args, **kwargs):
        super(URLInputForm, self).__init__(*args, **kwargs)
        self.fields['wordlist'].choices = self.get_wordlist_choices()

    def get_wordlist_choices(self):
        wordlist_dir = os.path.join(settings.BASE_DIR, 'config', 'word_lists')
        wordlist_files = os.listdir(wordlist_dir)
        return [(file, file) for file in wordlist_files if file.endswith('.txt')]
