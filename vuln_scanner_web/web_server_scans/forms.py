# web_server_scans/forms.py
from django import forms


class URLInputForm(forms.Form):
    url = forms.URLField(label='Enter URL (https://example.com)', required=True,
                         widget=forms.URLInput(attrs={'class': 'form-control'}))
    wordlist = forms.CharField(label='Wordlist', required=False)
    file_extensions = forms.CharField(
        label='File Extensions', required=False, help_text='Comma-separated, e.g., .php,.html')
    threads = forms.IntegerField(label='Threads', required=False, initial=200)

    def clean_file_extensions(self):
        extensions = self.cleaned_data.get('file_extensions')
        return [ext.strip() for ext in extensions.split(',')] if extensions else ['.php']
