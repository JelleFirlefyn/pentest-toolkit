# web_server_scans/tasks.py
from __future__ import absolute_import, unicode_literals
from celery import shared_task
from .web_server_package import directory_traversal
import os
from .web_server_package import wordpress_brute_force

@shared_task
def run_directory_traversal(target, wordlist_filename, file_extensions, resume):
    wordlist_path = os.path.join('config', 'word_lists', wordlist_filename)
    file_extensions_list = [ext.strip() for ext in file_extensions.split(',') if ext.strip()]
    
    return directory_traversal.main(target, wordlist_path, file_extensions_list, resume)

@shared_task(time_limit=30)
def brute_force_login_task(url, username, password,idx):
    print(idx)
    return wordpress_brute_force.attempt_login(url, username, password)