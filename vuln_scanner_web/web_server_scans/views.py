from django.shortcuts import render
from django.http import HttpResponse
from .forms import URLInputForm
from .web_server_package import server_software_eol

# Create your views here.


def index(request):
    return render(request, 'web_server_scans/index.html', {'current_page': 'web_server_scans'})


def web_server_scans_view(request):
    result = None
    if request.method == 'POST':
        form = URLInputForm(request.POST)
        if form.is_valid():
            url = form.cleaned_data['url']
            wordlist = form.cleaned_data['wordlist'] or 'test.txt'
            file_extensions = form.cleaned_data['file_extensions'] or '.php'
            threads = form.cleaned_data['threads'] or 200

            # Determine which button was clicked
            if 'check_server_software' in request.POST:
                checker = server_software_eol.ServerSoftwareCheck()
                result = checker.check(url)
                # Handle result for server software check
            elif 'other_function' in request.POST:
                # Handle other functionality

                pass
            # You can add more elif blocks for other buttons

    else:
        form = URLInputForm()

    return render(request, 'web_server_scans/index.html', {'form': form, 'result': result})
